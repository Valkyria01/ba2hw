##Homework 3 code here
library(readxl)
library(dplyr)
library(stringr)
library(ggplot2)
library(maps)
library(mapdata)
library(tmaptools)
library(raster)
library(osrm)
getwd()


#Create a bar chart showing the number of stores in the different provinces. 
#Add the percentage share (with 0 decimal places) of each province on the total number of stores on the top of the column,
#name the axes and save the bar chart.

#Load provinces:
Burgenland_Stores <- read.csv("Burgenland.csv", sep = "\t")
Carinthia_Stores <- read.csv("Carinthia.csv", sep = "\t")
Lower_Austria_Stores <- read.csv("Lower_Austria.csv", sep = "\t")
Salzburg_Stores <- read.csv("Salzburg.csv", sep = "\t")
Styria_Stores <- read.csv("Styria.csv", sep = "\t")
Tyrol_Stores <- read.csv("Tyrol.csv", sep = "\t")
Upper_Austria_Stores <- read.csv("Upper_Austria.csv", sep = "\t")
Vienna_Stores <- read.csv("Vienna.csv", sep = "\t")
Vorarlberg_Stores <- read.csv("Vorarlberg.csv", sep = "\t")

#Put provinces into the data frames themselves
Burgenland_Stores <- mutate(Burgenland_Stores, Province = "Burgenland")
Carinthia_Stores <- mutate(Carinthia_Stores, Province = "Carinthia")
Lower_Austria_Stores <- mutate(Lower_Austria_Stores, Province = "Lower Austria")
Salzburg_Stores <- mutate(Salzburg_Stores, Province = "Salzburg")
Styria_Stores <- mutate(Styria_Stores, Province = "Styria")
Tyrol_Stores <- mutate(Tyrol_Stores, Province = "Tyrol")
Upper_Austria_Stores <- mutate(Upper_Austria_Stores, Province = "Upper Austria")
Vienna_Stores <- mutate(Vienna_Stores, Province = "Vienna")
Vorarlberg_Stores <- mutate(Vorarlberg_Stores, Province = "Vorarlberg")

#Combine and group
Stores <- rbind(Burgenland_Stores, Carinthia_Stores, Lower_Austria_Stores, Salzburg_Stores, Styria_Stores, Tyrol_Stores, Upper_Austria_Stores, Vienna_Stores, Vorarlberg_Stores)
Stores <- mutate_at(Stores, "Province", as.factor)
Stores <- group_by(Stores, Province)
prov_sum <- summarise(Stores, n_Stores=n())
prov_sum

#Make plot
province_plot <- ggplot(prov_sum, aes(x = Province, y = n_Stores))
province_plot+geom_col(fill = "blue")+geom_text(aes(label=sprintf("%.0f%%",n_Stores/sum(n_Stores)*100),vjust=-0.3))+labs(x="Province",y="Number of Stores")

#Save the plot
ggsave("Stores.jpeg",height=7,width=7)


#Find the geocoordinates of all stores and store them in the .csv files with stores for each province
